<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">

    <!-- Overlay will be transparent in OBS -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <title>Discord Voice Overlay</title>

    <style>
        /* Reset default spacing */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            background: transparent;
            font-family: Arial, sans-serif;
            overflow: hidden;
        }

        /* Container holding all users */
        #voice-container {
            display: flex;
            gap: 12px;
            padding: 10px;
        }

        /* Individual user card */
        .user {
            width: 90px;
            height: 90px;
            border-radius: 12px;
            background: rgba(0, 0, 0, 0.5);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            transition: 0.15s ease;
        }

            /* User avatar */
            .user img {
                width: 48px;
                height: 48px;
                border-radius: 50%;
                margin-bottom: 6px;
            }

        /* Username */
        .username {
            font-size: 11px;
            color: white;
            text-align: center;
            max-width: 80px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        /* Talking state */
        .talking {
            outline: 3px solid #43b581;
        }

        /* Mic muted */
        .muted {
            opacity: 0.4;
        }

        /* Server muted / deafened */
        .fully-muted {
            filter: grayscale(100%);
            opacity: 0.3;
        }
    </style>
</head>
<body>

    <!-- Main container -->
    <div id="voice-container"></div>

    <!-- Discord Overlay SDK -->
    <script src="https://cdn.jsdelivr.net/npm/@discord/streamkit-overlay@latest/dist/overlay.min.js"></script>

    <script>
        /**
         * Initialize Discord StreamKit Overlay
         * Replace CLIENT_ID with your Discord Application Client ID
         */
        
        const clientId = "1456905240971313265";
        // const clientId = "YOUR_CLIENT_ID_HERE"; // https://discord.com/developers/applications

        const overlay = new DiscordOverlay.Overlay({
            clientId: clientId
        });

        const container = document.getElementById("voice-container");

        /**
         * Render users currently in the voice channel
         */
        function renderUsers(users) {
            container.innerHTML = "";

            users.forEach(user => {
                // Create user card
                const userDiv = document.createElement("div");
                userDiv.classList.add("user");

                // Apply mute states
                if (user.mute || user.selfMute) {
                    userDiv.classList.add("muted");
                }

                if (user.deaf || user.selfDeaf) {
                    userDiv.classList.add("fully-muted");
                }

                // Highlight when speaking
                if (user.speaking) {
                    userDiv.classList.add("talking");
                }

                // Avatar
                const avatar = document.createElement("img");
                avatar.src = user.avatar;

                // Username
                const name = document.createElement("div");
                name.classList.add("username");
                name.textContent = user.username;

                // Build card
                userDiv.appendChild(avatar);
                userDiv.appendChild(name);

                container.appendChild(userDiv);
            });
        }

        /**
         * Listen for voice state updates
         */
        overlay.on("voiceStateUpdate", event => {
            renderUsers(event.users);
        });

        /**
         * Initial ready event
         */
        overlay.on("ready", () => {
            console.log("Discord Voice Overlay Ready");
        });
    </script>

</body>
</html>
